<?php 
/**
 * @category   OntoWiki
 * @package    OntoWiki_extensions_formgenerator
 * @author     Lars Eidam <larseidam@googlemail.com>
 * @author     Konrad Abicht <konrad@inspirito.de>
 * @copyright  Copyright (c) 2011
 * @license    http://opensource.org/licenses/gpl-license.php GNU General Public License (GPL)
 */ 
?>
<?php 
    $classes = array ();
    foreach ($element ['typeparameter'] as $item)
    {
        $classesResult = array();
        if (isset($item['relation'])) {
            $classesResult = $this->store->sparqlQuery(
                'SELECT DISTINCT ?uri 
                 WHERE {
                     {?uri <'. $item['relation'] .'> <'. $item['class'] .'>.}
                   UNION{?subclass <http://www.w3.org/2000/01/rdf-schema#subClassOf> <'. $item['class'] .'>.
  ?uri <'. $item['relation'] .'> ?subclass.}
                 };'
            );
            $classes = array_merge($classes, $classesResult);
        }
        else
        {
            $classes[]['uri'] = $item['class'];
        }
    }
    foreach ($classes as $class) {
        $this->titleHelper->addResource($class['uri']);
    }
    foreach ($classes as $classNumber => $class) {
        $classes[$classNumber]['label'] = $this->titleHelper->getTitle($class['uri'], $this->selectedLanguage);
    }
    
?>
<div class="predicateValue">
    <?php foreach ( $classes as $class ) { ?>
        <div class="divClassPredicateValue">
            <div class="divClassPredicateValueInput"><input type="checkbox" class="predicateValue_Class" name="<?php echo $element ['name']; ?>" value="<?php echo $class ['uri']; ?>"<?php echo ((is_array($element['value']) && false !== array_search($class['uri'], $element['value'])) || ($class['uri'] == $element['value']) ? ' checked="checked"' : ''); ?>/></div><div class="clear"><?php echo $class ['label']; ?></div>
        </div>
    <?php } ?>
</div>
